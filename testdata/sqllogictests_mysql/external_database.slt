# Basic test for external database.

statement ok
CREATE EXTERNAL DATABASE external_database
	FROM mysql
	OPTIONS (
		connection_string = '${MYSQL_CONN_STRING}',
	);

query I
SELECT count(*) FROM external_database.glaredb_test.bikeshare_stations;
----
102

statement ok
DROP DATABASE external_database;

# Check if external database works with expanded options.

statement ok
CREATE EXTERNAL DATABASE external_database
	FROM mysql
	OPTIONS (
		host = '127.0.0.1',
		port = '3307',
		user = 'root',
		database = 'glaredb_test',
	);

query I
SELECT count(*) FROM external_database.glaredb_test.bikeshare_stations;
----
102

# Ensure we can query into the virtual schema.

query T
SELECT * FROM external_database.virtual_catalog.schemata WHERE schema_name = 'glaredb_test';
----
glaredb_test

query TT
SELECT table_schema, table_name
	FROM external_database.virtual_catalog.tables
	WHERE table_name = 'bikeshare_stations';
----
glaredb_test  bikeshare_stations

query TT
SELECT table_schema, table_name
	FROM external_database.virtual_catalog.tables
	WHERE table_schema = 'glaredb_test' AND table_name = 'bikeshare_stations';
----
glaredb_test  bikeshare_stations

statement ok
DROP DATABASE external_database;
