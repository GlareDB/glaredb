# Validation tests for postgres connections and external tables

include ./include/conn.slti

# Validation test error with the wrong password
statement error
CREATE CONNECTION wrong_password
	FOR postgres
	OPTIONS (
		postgres_conn = 'host=localhost port=5432 user=glaredb password=wrong-password dbname=glaredb_test sslmode=disable',
	);

statement error
CREATE CONNECTION non_existant_user
	FOR postgres
	OPTIONS (
		postgres_conn = 'host=localhost port=5432 user=missing password=password dbname=glaredb_test sslmode=disable',
	);

# Validation test error with the wrong host
statement error
CREATE CONNECTION wrong_host
	FOR postgres
	OPTIONS (
		postgres_conn = 'host=non-existant port=5432 user=glaredb password=password dbname=glaredb_test sslmode=disable',
	);

# Validation test error with the wrong table name
statement error
CREATE EXTERNAL TABLE missing_table
	FROM testconn
	OPTIONS (
		schema = 'public',
		table = 'missing_table'
	);

# Validation test error with the wrong table name
statement error
CREATE EXTERNAL TABLE missing_schema
	FROM testconn
	OPTIONS (
		schema = 'missing_schema',
		table = 'datatypes'
	);
