# Basic tests for postgres external tables 

# Create a connection to local postgres test database.
statement ok
CREATE CONNECTION testconn
	FOR postgres
	OPTIONS (
		postgres_conn = 'host=localhost port=5432 user=glaredb password=password dbname=glaredb_test sslmode=disable',
	);

# Create an external table that connects to the datatypes table.
statement ok
CREATE EXTERNAL TABLE datatypes
	FROM testconn
	OPTIONS (
		schema = 'public',
		table = 'datatypes'
	);

# Check if we can fetch contents of the datatype table.
query TIIIRRTTTTTTTT
SELECT * FROM datatypes;
----
t  1  2  3  4.5  6.7  a  b  cde  fghi  {"a":[1,2]}  [{"b":null},{"c":true}]  292a485f-a56a-4938-8f1a-bbbbbbbbbbb1  98,105,110
