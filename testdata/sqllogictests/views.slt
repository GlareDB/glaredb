# View tests

statement ok
create schema views;

statement ok
set search_path = views;

# Unaliased select

statement ok
create view with_select as select 1;

query I
select * from with_select;
----
1

# Aliased select

statement ok
create view with_alias as select 1 as a, 2 as b;

query I
select * from with_alias;
----
1  2

query I
select b from with_alias;
----
2

# Values

statement ok
create view with_values as values (1,2), (3,4);

query II
select * from with_values order by 1;
----
1  2
3  4

# Replace views

statement ok
create view my_view as select 1;

query I
select * from my_view;
----
1

statement error
create view my_view as select 2;

# No change should have been made.
query I
select * from my_view;
----
1

statement ok
create or replace view my_view as select 3;

# View should have been replaced.
query I
select * from my_view;
----
3
