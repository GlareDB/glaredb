# Test that debug data sources do what they would expect.

statement ok
create schema debug_datasources;

statement ok
set search_path = debug_datasources;

statement ok
set enable_debug_datasources to false;

# Ensure we can't create a debug connection if above var is false.

statement error
create connection debug_conn for debug;

# Enable debug table creates.

statement ok
set enable_debug_datasources to true;

statement ok
create connection debug_conn for debug;

statement ok
create external table error_table from debug_conn options (table_type = 'error_during_execution');

# Should always error.

statement error
select * from error_table;

# validate external column catalog info
query TTTITTT
select schema_name, table_name, column_name, column_index, data_type,
    pg_data_type, is_nullable
    from glare_catalog.external_columns where table_name = 'error_table';
----
debug_datasources error_table a 0 Int32 Int32 f
