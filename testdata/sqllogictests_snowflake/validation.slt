# External connection validation tests

# Incorrect credentials

statement error
CREATE EXTERNAL DATABASE validation
	FROM snowflake
	OPTIONS (
		account_name = 'hmpfscx-xo23956',
		login_name = '${SNOWFLAKE_USERNAME}',
		password = 'incorrect-password',
		database_name = '${SNOWFLAKE_DATABASE}',
		warehouse = 'compute_wh',
		role_name = 'accountadmin',
	);

statement error
CREATE EXTERNAL TABLE validation
	FROM snowflake
	OPTIONS (
		account_name = 'hmpfscx-xo23956',
		login_name = '${SNOWFLAKE_USERNAME}',
		password = 'incorrect-password',
		database_name = '${SNOWFLAKE_DATABASE}',
		warehouse = 'compute_wh',
		role_name = 'accountadmin',
		schema_name = 'public',
		table_name = 'datatypes',
	);

# Incorrect schema/table name

statement error
CREATE EXTERNAL TABLE validation
	FROM snowflake
	OPTIONS (
		account_name = 'hmpfscx-xo23956',
		login_name = '${SNOWFLAKE_USERNAME}',
		password = 'incorrect-password',
		database_name = '${SNOWFLAKE_DATABASE}',
		warehouse = 'compute_wh',
		role_name = 'accountadmin',
		schema_name = 'public',
		table_name = 'incorrect_table',
	);

statement error
CREATE EXTERNAL TABLE validation
	FROM snowflake
	OPTIONS (
		account_name = 'hmpfscx-xo23956',
		login_name = '${SNOWFLAKE_USERNAME}',
		password = 'incorrect-password',
		database_name = '${SNOWFLAKE_DATABASE}',
		warehouse = 'compute_wh',
		role_name = 'accountadmin',
		schema_name = 'incorrect_schema',
		table_name = 'datatypes',
	);
