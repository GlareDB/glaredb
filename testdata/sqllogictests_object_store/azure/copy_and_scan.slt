# Basic tests for copy to.

# TODO: These don't seem to be isolated? What happens if there's two CI runs
# happening?

statement ok
COPY ( SELECT 1 AS a, 2 AS b, 3 AS c ) TO azure
	OPTIONS (
		account_name = '${AZURE_ACCOUNT}',
		access_key = '${AZURE_ACCESS_KEY}',
		location = 'azure://glaredb-test/copy_to/with_opts.csv'
	);

query II
SELECT * FROM csv_scan(
	'azure://glaredb-test/copy_to/with_opts.csv',
	account_name => '${AZURE_ACCOUNT}',
	access_key => '${AZURE_ACCESS_KEY}'
);
----
1   2   3

statement ok
COPY ( SELECT 3 AS a, 4 AS b, 5 AS c )
	TO 'azure://glaredb-test/copy_to/with_url.csv'
	OPTIONS (
		account_name = '${AZURE_ACCOUNT}',
		access_key = '${AZURE_ACCESS_KEY}',
	);

query II
SELECT c, b, a FROM csv_scan(
	'azure://glaredb-test/copy_to/with_url.csv',
	account_name => '${AZURE_ACCOUNT}',
	access_key => '${AZURE_ACCESS_KEY}'
);
----
5   4   3
