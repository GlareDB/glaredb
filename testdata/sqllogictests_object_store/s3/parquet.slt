# Creating external tables with parquet files.

statement ok
create schema parquet_s3;

statement ok
set search_path = parquet_s3;

include ./include/conn.slti

statement ok
CREATE EXTERNAL TABLE userdata1
    FROM testconn
    OPTIONS (
        region = '${AWS_S3_REGION}',
        bucket_name = '${AWS_S3_BUCKET_NAME}',
        location = 'userdata1.parquet'
    );

statement ok
select * from userdata1;

query I
select count(*) from userdata1;
----
1000

query IT
select count(*), gender from userdata1 group by gender order by gender;
----
67   (empty)
482  Female
451  Male
