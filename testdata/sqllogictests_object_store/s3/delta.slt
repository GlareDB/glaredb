statement ok
CREATE CREDENTIALS aws_creds PROVIDER aws
	OPTIONS (
        access_key_id = '${AWS_ACCESS_KEY_ID}',
        secret_access_key = '${AWS_SECRET_ACCESS_KEY}',
	);

# Tests `delta_scan` with delta table in s3.

query IT
select * from delta_scan('s3://${AWS_S3_BUCKET_NAME}/delta/table1', aws_creds, region => '${AWS_S3_REGION}') order by a;
----
1   hello
2   world

# Tests external delta table in s3 with credentials object.
statement ok
create external table delta_s3_creds
from delta
credentials aws_creds
options (
	location 's3://${AWS_S3_BUCKET_NAME}/delta/table1'
);

query IT
select * from delta_s3_creds order by a;
----
1   hello
2   world

# Tests external delta table in s3 with explicit config options.
statement ok
create external table delta_s3_options
from delta
options (
	location 's3://${AWS_S3_BUCKET_NAME}/delta/table1',
	access_key_id = '${AWS_ACCESS_KEY_ID}',
    secret_access_key = '${AWS_SECRET_ACCESS_KEY}'
);

query IT
select * from delta_s3_options order by a;
----
1   hello
2   world
